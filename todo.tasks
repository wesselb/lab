TODO:
     â˜ Add tests, mainly to test dispatch. @critical